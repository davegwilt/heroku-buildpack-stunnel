#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

# fail fast
set -e

# debug
# set -x

# parse and derive params
BUILD_DIR=$1
CACHE_DIR=$2
LP_DIR=`cd $(dirname $0); cd ..; pwd`

echo "-----> Fetching and vendoring stunnel into slug"
VENDORED_STUNNEL="vendor/stunnel"
PATH="$BUILD_DIR/$VENDORED_STUNNEL/bin:$PATH"
mkdir -p "$BUILD_DIR/$VENDORED_STUNNEL"
tar -xzf "$LP_DIR/support_files/stunnel4_4.53-1.1ubuntu1_amd64.tgz" -C "$BUILD_DIR/$VENDORED_STUNNEL"

